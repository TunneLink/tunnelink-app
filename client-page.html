<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TunneLink</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="stylesheet.css">
    <link rel="icon" href="TunneLink logo.png" type="image/png">
</head>

<body>
    <header class="headerbar">
        <div style="text-align: center;"><img src="tunnelink-logo.png"
            style="width: 180px; height: 75px;"></div>
    </header>

    <div class="center">
        <h1 class="red-hat-display-normal small" style="font-size: 32px;">INPUT PAIRING CODE</h1>
        <div class="pairing-code-container" style="margin-top: -35px;">
            <div class="pairing-code">
                <!-- Input fields for pairing code, allowing only numbers -->
                <input id="input1" class="no-cursor" type="text" maxlength="1" inputmode="numeric" pattern="[0-9]*" readonly onfocus="this.removeAttribute('readonly')">
                <input id="input2" class="no-cursor" type="text" maxlength="1" inputmode="numeric" pattern="[0-9]*" readonly onfocus="this.removeAttribute('readonly')">
                <input id="input3" class="no-cursor" type="text" maxlength="1" inputmode="numeric" pattern="[0-9]*" readonly onfocus="this.removeAttribute('readonly')">
                <input id="input4" class="no-cursor" type="text" maxlength="1" inputmode="numeric" pattern="[0-9]*" readonly onfocus="this.removeAttribute('readonly')">
            </div>
            <p id="errorMessage" class="red-hat-display-normal" style="color: red; display: none; margin-top: 20px; margin-bottom: -40px;">Incorrect code. Please try again.</p>
            <button onclick="checkPairingCode()" style="margin-top: 50px; width: 150px; font-size: 16px;" class="red-hat-display-normal small">CONFIRM</button>
        </div>
    </div>
    
    <script>
        window.onload = function() {
            // Focus on the first input field when the page loads
            document.getElementById("input1").focus();
        };
    
        // Add event listeners to auto-focus the next field and restrict input to numbers only
        const inputs = document.querySelectorAll('.pairing-code input');
        inputs.forEach((input, index) => {
            input.addEventListener('input', () => {
                input.value = input.value.replace(/[^0-9]/g, ''); // Only allow numbers
                if (input.value.length === 1 && index < inputs.length - 1) {
                    inputs[index + 1].focus();
                }
            });
        });
    </script>
    
    <script>
        // Event listener to detect clicks anywhere on the page
        document.addEventListener('click', function (event) {
            const inputs = document.querySelectorAll('.pairing-code input');
            let allFilled = true;
            let firstEmptyInput = null;
            
            inputs.forEach(input => {
                if (input.value === '') {
                    allFilled = false;
                    if (!firstEmptyInput) {
                        firstEmptyInput = input;
                    }
                }
            });
            
            // If there's an empty input, refocus on the first empty one
            if (!allFilled && !event.target.matches('.pairing-code input')) {
                firstEmptyInput.focus();
            }
        });
    </script>    

    <script>
         // Add event listeners after the DOM is fully loaded
         document.addEventListener('DOMContentLoaded', function () {
            const inputs = document.querySelectorAll('.pairing-code input');
            inputs.forEach((input, index) => {
                input.addEventListener('input', function () {
                    moveToNext(this, inputs[index + 1]);
                });
                input.addEventListener('keydown', function (event) {
                    moveToPrev(event, inputs[index - 1]);
                    detectEnterKey(event);
                });
            });
        });
        function moveToNext(current, nextField) {
            if (current.value.length === 1 && nextField) {
                nextField.focus();
            }
        }
        function moveToPrev(event, prevField) {
            if (event.key === "Backspace" && event.target.value === "" && prevField) {
                prevField.focus();
            }
        }
        function getInputValues() {
            // Get the value of each input field
            const inputs = document.querySelectorAll('.pairing-code input');
            let pairingCode = '';
            inputs.forEach(input => pairingCode += input.value);
            return pairingCode;
        }
        function detectEnterKey(event) {
            if (event.key === "Enter") {
                checkPairingCode();
            }
        }
        function checkPairingCode() {
            const correctCode = "1234"; // Replace with the actual correct code
            const userInput = getInputValues();
            if (userInput === correctCode) {
                window.location.href = 'loading-page-client.html'
            } else {
                document.getElementById('errorMessage').style.display = 'block';
            }
        }
    </script>
    
</body>
</html>
